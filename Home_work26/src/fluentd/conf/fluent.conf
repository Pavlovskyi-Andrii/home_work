<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

# Парсим только сообщения нашего приложения (тег задаётся в compose)
<filter nodejs.app>
  @type parser
  key_name log
  reserve_data true
  <parse>
    @type json
  </parse>
</filter>

# Внутренние логи Fluentd — отдельно, чтобы не ломать парсер
<label @FLUENT_LOG>
  <match **>
    @type stdout
  </match>
</label>

<match **>
  @type elasticsearch
  hosts elasticsearch:9200
  logstash_format true
  include_tag_key true
  reconnect_on_error true
  reload_connections true
  request_timeout 60s
</match>

